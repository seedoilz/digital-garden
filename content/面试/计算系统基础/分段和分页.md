---
aliases:
  - 分段
  - 分页
title: 分段和分页
date created: 2024-08-11 16:08:00
date modified: 2024-08-11 17:08:71
---
## 分段
>将一个程序分成代码段，数据段，堆栈段什么的，每个段各自管理不同的数据

从上面的图片可以看出，程序被分成段之后，其在程序中操作的地址就是段地址（虚拟地址），分段技术把虚拟地址空间映射到了物理地址空间，并且你写的程序操作的是虚拟地址。
![image.png](https://typora-tes.oss-cn-shanghai.aliyuncs.com/picgo/20240811170831.png)
### 解决的问题
#### 地址空间不隔离
不会导致程序A越界访问程序B中的内存地址，因为访问的是虚拟地址，当操作系统解析虚拟地址的时候会进行处理。
#### 程序运行时候的地址不确定
因为我们程序每次要运行的时候，都是需要装载到内存中的，假设你在程序中写死了要操作某个地址的内存，例如你要地址 0x00000010。但是问题来了，你能够保证你操作的地址 0x00000010 真的就是你原来想操作的那个位置吗？正是因为这种映射，使得程序**无需关注物理地址**是多少，只要虚拟地址没有改变，那么，程序就不会操作地址不当

## 分页
### 原理
- 分页这个技术仍然是一种虚拟地址空间到物理地址空间映射的机制。但是，粒度更加的小了。单位不是整个程序，而是某个 “页”，一段虚拟地址空间组成的某一页映射到一段物理地址空间组成的某一页
- 分页这个技术，它的虚拟地址空间仍然是连续的，但是，每一页映射后的物理地址就不一定是连续的了。正是因为有了分页的概念，程序的换入换出就可以以页为单位了。那么，为什么就可以只换出某一页呢？实际上，不是为什么可以换出某一页，而是可以换出 CPU 还用不到的那些程序代码、数据。但是，把这些都换出到磁盘，万一下次 CPU 就要使用这些代码和数据怎么办？又得把这些代码、数据装载进内存。性能有影响对吧。所以，我们把换入换出的单位变小，变成了 “页”。（实际上，这利用了空间局部性）

### 解决的问题
#### 内存使用率低下
- 举个例子，假设你写了3个程序，其中程序A大小为10M，程序B为70M，程序C的大小为30M，但是你的计算机的内存总共有100M。这三个程序加起来有110M，显然这三个程序是无法**同时**存在于内存中的。
- 分页可以使换出的程序部分（不需要的程序部分）比较小，性能能够提高。